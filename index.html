<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 2454" preserveAspectRatio="xMidYMid meet"
     style="max-width:100vw; max-height:100vh; width:auto; height:auto; display:block; background:black;">
  <g transform="translate(0,0)" id="main-group">
    <!-- الصورة الأصلية الكبيرة -->
    <image href="image/1.png" width="1024"/>

    <!-- المربعات مع روابطها -->
    <a href="micro/1.pdf" target="_blank">
      <rect x="368" y="703" width="115" height="380" class="image-mapper-shape"/>
    </a>
    <a href="patho/1.pdf" target="_blank">
      <rect x="368" y="1083" width="115" height="253.5" class="image-mapper-shape"/>
    </a>
    <a href="patho/q1.pdf" target="_blank">
      <rect x="368" y="1339" width="115" height="125" id="red" class="image-mapper-shape"/>
    </a>
    <a href="physio/2.pdf" target="_blank">
      <rect x="368" y="1465" width="115" height="380" class="image-mapper-shape"/>
    </a>
    <a href="anatomy/1.pdf" target="_blank">
      <rect x="368" y="1845" width="115" height="380" class="image-mapper-shape"/>
    </a>
    <a href="physio/1.pdf" target="_blank">
      <rect x="598" y="366" width="114.5" height="315" class="image-mapper-shape"/>
    </a>
    <a href="#" target="_blank">
      <rect x="712.35" y="702" width="115" height="380" class="image-mapper-shape"/>
    </a>
    <a href="#" target="_blank">
      <rect x="712.35" y="1465" width="115" height="380" class="image-mapper-shape"/>
    </a>
    <a href="physio/2.pdf" target="_blank">
      <rect x="598" y="1846" width="115" height="380" class="image-mapper-shape"/>
    </a>
  </g>

  <!-- نسخة الصورة فوق المربعات لتكبير الجزء المقصوص فقط -->
  <image id="zoom-image" href="image/1.png" width="1024"
         style="pointer-events:none; transform-origin: top left; transition: transform 0.3s ease, filter 0.3s ease; opacity:0;"/>

  <style>
    .image-mapper-shape {
      fill: transparent;
      stroke: yellow;
      stroke-width: 2px;
      transition: stroke 0.3s ease, transform 0.3s ease, filter 0.3s ease;
    }
    .image-mapper-shape#red { stroke: red; }
    a:hover .image-mapper-shape { stroke: orange; }
  </style>

  <script>
    const zoomImage = document.getElementById('zoom-image');
    const mainGroup = document.getElementById('main-group');

    function attachHoverEffect(rect) {
      rect.addEventListener('mouseenter', () => {
        const x = parseFloat(rect.getAttribute('x'));
        const y = parseFloat(rect.getAttribute('y'));
        const width = parseFloat(rect.getAttribute('width'));
        const height = parseFloat(rect.getAttribute('height'));

        // مركز المربع
        const cx = x + width / 2;
        const cy = y + height / 2;

        const scale = 1.1; // تكبير خفيف
        const tx = -cx * (scale - 1);
        const ty = -cy * (scale - 1);

        // نطبق التكبير والتوهج على نسخة الصورة + المربع فقط
        zoomImage.style.transform = `translate(${tx}px, ${ty}px) scale(${scale})`;
        zoomImage.style.filter = 'drop-shadow(0 0 8px orange)';
        zoomImage.style.opacity = 1;
      });

      rect.addEventListener('mouseleave', () => {
        zoomImage.style.transform = 'translate(0,0) scale(1)';
        zoomImage.style.filter = 'none';
        zoomImage.style.opacity = 0;
      });
    }

    // نطبق على كل المربعات الحالية
    mainGroup.querySelectorAll('.image-mapper-shape').forEach(attachHoverEffect);

    // مراقبة أي مربعات جديدة تُضاف تلقائيًا
    const observer = new MutationObserver(mutations => {
      mutations.forEach(mutation => {
        mutation.addedNodes.forEach(node => {
          if (node.tagName === 'A') {
            const rect = node.querySelector('rect.image-mapper-shape');
            if (rect) attachHoverEffect(rect);
          }
        });
      });
    });

    observer.observe(mainGroup, { childList: true, subtree: true });
  </script>
</svg>